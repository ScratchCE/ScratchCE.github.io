const ve=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};ve();function C(){}function ce(t){return t()}function ie(){return Object.create(null)}function B(t){t.forEach(ce)}function ye(t){return typeof t=="function"}function ue(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Q;function je(t,e){return Q||(Q=document.createElement("a")),Q.href=e,t===Q.href}function Se(t){return Object.keys(t).length===0}function w(t,e){t.appendChild(e)}function y(t,e,n){t.insertBefore(e,n||null)}function v(t){t.parentNode.removeChild(t)}function _(t){return document.createElement(t)}function X(t){return document.createTextNode(t)}function z(){return X(" ")}function fe(){return X("")}function N(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function we(t){return Array.from(t.childNodes)}function se(t,e){t.value=e==null?"":e}function V(t,e,n){t.classList[n?"add":"remove"](e)}function ke(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}let J;function G(t){J=t}function de(){if(!J)throw new Error("Function called outside component initialization");return J}function Te(t){de().$$.on_mount.push(t)}function Ce(){const t=de();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=ke(e,n,{cancelable:r});return i.slice().forEach(s=>{s.call(t,o)}),!o.defaultPrevented}return!0}}const H=[],M=[],$=[],ne=[],Ee=Promise.resolve();let re=!1;function xe(){re||(re=!0,Ee.then(he))}function oe(t){$.push(t)}function q(t){ne.push(t)}const te=new Set;let Z=0;function he(){const t=J;do{for(;Z<H.length;){const e=H[Z];Z++,G(e),Pe(e.$$)}for(G(null),H.length=0,Z=0;M.length;)M.pop()();for(let e=0;e<$.length;e+=1){const n=$[e];te.has(n)||(te.add(n),n())}$.length=0}while(H.length);for(;ne.length;)ne.pop()();re=!1,te.clear(),G(t)}function Pe(t){if(t.fragment!==null){t.update(),B(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(oe)}}const ee=new Set;let Le;function pe(t,e){t&&t.i&&(ee.delete(t),t.i(e))}function Re(t,e,n,r){if(t&&t.o){if(ee.has(t))return;ee.add(t),Le.c.push(()=>{ee.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function D(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Me(t){t&&t.c()}function me(t,e,n,r){const{fragment:i,on_mount:o,on_destroy:s,after_update:f}=t.$$;i&&i.m(e,n),r||oe(()=>{const c=o.map(ce).filter(ye);s?s.push(...c):B(c),t.$$.on_mount=[]}),f.forEach(oe)}function _e(t,e){const n=t.$$;n.fragment!==null&&(B(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ie(t,e){t.$$.dirty[0]===-1&&(H.push(t),xe(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function be(t,e,n,r,i,o,s,f=[-1]){const c=J;G(t);const u=t.$$={fragment:null,ctx:null,props:o,update:C,not_equal:i,bound:ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:ie(),dirty:f,skip_bound:!1,root:e.target||c.$$.root};s&&s(u.root);let E=!1;if(u.ctx=n?n(t,e.props||{},(b,j,...k)=>{const p=k.length?k[0]:j;return u.ctx&&i(u.ctx[b],u.ctx[b]=p)&&(!u.skip_bound&&u.bound[b]&&u.bound[b](p),E&&Ie(t,b)),j}):[],u.update(),E=!0,B(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const b=we(e.target);u.fragment&&u.fragment.l(b),b.forEach(v)}else u.fragment&&u.fragment.c();e.intro&&pe(t.$$.fragment),me(t,e.target,e.anchor,e.customElement),he()}G(c)}class ge{$destroy(){_e(this,1),this.$destroy=C}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Se(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ze(t){let e,n,r,i;return{c(){e=_("div"),n=_("div"),r=_("iframe"),m(r,"title",""),m(r,"scrolling","no"),m(r,"width","482"),m(r,"height","406"),je(r.src,i="about:blank")||m(r,"src",i),m(r,"class","svelte-19fn9ge"),V(r,"fill-screen",["fullscreen","editor","fullscreen-editor"].includes(t[0])),m(n,"id","scratch-gui"),m(n,"class","svelte-19fn9ge"),V(n,"show",t[1]==="ok")},m(o,s){y(o,e,s),w(e,n),w(n,r),t[10](r)},p(o,[s]){s&1&&V(r,"fill-screen",["fullscreen","editor","fullscreen-editor"].includes(o[0])),s&2&&V(n,"show",o[1]==="ok")},i:C,o:C,d(o){o&&v(e),t[10](null)}}}function Ne(t,e,n){let{id:r=0}=e,{editor:i=!1}=e,{params:o={}}=e,{serverUrl:s}=e,{projectStatus:f="notloaded"}=e,{reduxTarget:c=null}=e,{reduxStore:u=null}=e,{playerMode:E="player"}=e,{projectTitle:b=""}=e,j=!1;if(!s)throw new Error("The server URL must be defined!");const k=Ce();let p,S,x,g,I;Te(async()=>{x=s,g=`${x}/projects`,I=`${x}/assets`,await h(),S=p.contentWindow,p.addEventListener("load",async()=>{const a=async function(){n(4,c=S.ReduxTarget),n(5,u=S.ReduxStore);const L=u,R=c;d(480,360);const P=L.getState().scratchGui;P.customStageSize&&P.customStageSize.width&&P.customStageSize.height&&d(P.customStageSize.width,P.customStageSize.height),P.mode&&U(P.mode),P.projectTitle&&n(3,b=P.projectTitle),R.addEventListener("statechanged",K=>{const Y=K.detail.action;switch(k("reduxevent",K.detail),console.log(K.detail),Y.type){case"tw/custom-stage-size/SET":console.log("gui frame:",p),d(Y.width,Y.height),k("stagesize",{width:Y.width,action:p.height});break;case"scratch-gui/mode/SET_FULL_SCREEN":case"scratch-gui/mode/SET_PLAYER":U(K.detail.next.scratchGui.mode);break;case"projectTitle/SET_PROJECT_TITLE":j=!0,n(3,b=Y.title);break}})};S.addEventListener("reduxtargetadded",a),S.ReduxTarget&&a()})});async function O(a){if(j){j=!1;return}!S||(await h(a),S.location.hash="#"+r)}function F(a){if(j){j=!1;return}!u||u.dispatch({type:"projectTitle/SET_PROJECT_TITLE",title:a})}function A(a){if(j){j=!1;return}!u||(u.dispatch({type:"scratch-gui/mode/SET_PLAYER",isPlayerOnly:a==="player"||a==="fullscreen"||a==="fullscreen-editor"}),u.dispatch({type:"scratch-gui/mode/SET_FULL_SCREEN",isFullScreen:a==="fullscreen"||a==="fullscreen-editor"}))}function U(a){j=!0,n(0,E=a?a.isPlayerOnly?a.isFullScreen?"fullscreen":"player":a.isFullScreen?"fullscreen-editor":"editor":"player")}async function h(a=r){if(n(1,f="loading"),a===0)return n(1,f="notloaded"),l(!1),!1;if(Number(a))try{return(await fetch(`${g}/${a}/exists`)).ok?(n(1,f="ok"),l(!0),S&&(S.location.hash="#"+a),!0):(n(1,f="noproject"),l(!1),!1)}catch{try{if((await fetch(`${x}`)).ok)return n(1,f="projectunavailable"),l(!1),!1}catch(R){return console.log(R),n(1,f="unavailable"),l(!1),!1}}else return l(!1),!1;return n(1,f="unavailable"),l(!1),!1}function d(a,L){p.setAttribute("width",Math.max(a+2,482)),p.setAttribute("height",L+2+44),k("framesize",{width:p.width,height:p.height})}function l(a){if(a){if(p.src==="about:blank"){const L=new URLSearchParams;L.set("project_host",g),L.set("asset_host",I);for(const P in o)L.set(P,o[P]);let R=L.toString();R=R===""?"":"?"+R,n(2,p.src="/gui/"+(i?"editor.html":"index.html")+R+"#"+r,p)}S&&(S.location.hash="#"+r)}else n(2,p.src="about:blank",p)}function T(a){M[a?"unshift":"push"](()=>{p=a,n(2,p)})}return t.$$set=a=>{"id"in a&&n(6,r=a.id),"editor"in a&&n(7,i=a.editor),"params"in a&&n(8,o=a.params),"serverUrl"in a&&n(9,s=a.serverUrl),"projectStatus"in a&&n(1,f=a.projectStatus),"reduxTarget"in a&&n(4,c=a.reduxTarget),"reduxStore"in a&&n(5,u=a.reduxStore),"playerMode"in a&&n(0,E=a.playerMode),"projectTitle"in a&&n(3,b=a.projectTitle)},t.$$.update=()=>{t.$$.dirty&1&&A(E),t.$$.dirty&8&&F(b),t.$$.dirty&64&&O(r)},[E,f,p,b,c,u,r,i,o,s,T]}class Oe extends ge{constructor(e){super(),be(this,e,Ne,ze,ue,{id:6,editor:7,params:8,serverUrl:9,projectStatus:1,reduxTarget:4,reduxStore:5,playerMode:0,projectTitle:3})}}function Fe(t){let e,n,r,i,o=!t[5].create&&Ge(t),s=!t[5].name&&Je(t),f=!t[5].seeInside&&We(t);return{c(){e=_("div"),n=_("div"),o&&o.c(),r=z(),s&&s.c(),i=z(),f&&f.c(),m(n,"class","controls svelte-2v4sah"),m(e,"class","controls-container svelte-2v4sah")},m(c,u){y(c,e,u),w(e,n),o&&o.m(n,null),w(n,r),s&&s.m(n,null),w(n,i),f&&f.m(n,null)},p(c,u){c[5].create||o.p(c,u),c[5].name||s.p(c,u),c[5].seeInside||f.p(c,u)},d(c){c&&v(e),o&&o.d(),s&&s.d(),f&&f.d()}}}function Ae(t){let e;return{c(){e=_("p"),e.textContent="Loading..."},m(n,r){y(n,e,r)},p:C,d(n){n&&v(e)}}}function Ue(t){let e;return{c(){e=_("p"),e.textContent="Somehow, we couldn't reach the project API but the servers work. What?"},m(n,r){y(n,e,r)},p:C,d(n){n&&v(e)}}}function Ye(t){let e;return{c(){e=_("p"),e.textContent="The project you tried to load doesn't exist."},m(n,r){y(n,e,r)},p:C,d(n){n&&v(e)}}}function qe(t){let e,n,r,i,o;return{c(){e=_("p"),n=X("Couldn't reach servers. They are probably down or the browser is blocking the requests. Try visiting "),r=_("a"),i=X(W),o=X(" in your browser and allowing the page to load."),m(r,"href",W)},m(s,f){y(s,e,f),w(e,n),w(e,r),w(r,i),w(e,o)},p:C,d(s){s&&v(e)}}}function De(t){let e;return{c(){e=_("p"),e.textContent="Invalid project ID!"},m(n,r){y(n,e,r)},p:C,d(n){n&&v(e)}}}function He(t){let e;return{c(){e=_("p"),e.textContent="Creating project..."},m(n,r){y(n,e,r)},p:C,d(n){n&&v(e)}}}function Xe(t){let e;function n(o,s){return o[5].id?Ke:Be}let i=n(t)(t);return{c(){i.c(),e=fe()},m(o,s){i.m(o,s),y(o,e,s)},p:C,d(o){i.d(o),o&&v(e)}}}function Ge(t){let e,n,r;return{c(){e=_("button"),e.textContent="Create",m(e,"class","svelte-2v4sah")},m(i,o){y(i,e,o),n||(r=N(e,"click",t[7]),n=!0)},p:C,d(i){i&&v(e),n=!1,r()}}}function Je(t){let e,n,r;return{c(){e=_("input"),m(e,"class","title-input svelte-2v4sah"),m(e,"type","text"),m(e,"placeholder","Project title here")},m(i,o){y(i,e,o),se(e,t[0]),n||(r=N(e,"input",t[8]),n=!0)},p(i,o){o&1&&e.value!==i[0]&&se(e,i[0])},d(i){i&&v(e),n=!1,r()}}}function We(t){let e,n,r;return{c(){e=_("button"),e.textContent="See inside",m(e,"class","svelte-2v4sah")},m(i,o){y(i,e,o),n||(r=N(e,"click",t[9]),n=!0)},p:C,d(i){i&&v(e),n=!1,r()}}}function Be(t){let e;return{c(){e=_("p"),e.textContent="Load a project ID!"},m(n,r){y(n,e,r)},d(n){n&&v(e)}}}function Ke(t){let e;return{c(){e=_("p"),e.textContent="No project loaded."},m(n,r){y(n,e,r)},d(n){n&&v(e)}}}function ae(t){let e,n,r=!t[5].id&&Qe(t),i=!t[5].random&&Ve(t);return{c(){r&&r.c(),e=z(),i&&i.c(),n=fe()},m(o,s){r&&r.m(o,s),y(o,e,s),i&&i.m(o,s),y(o,n,s)},p(o,s){o[5].id||r.p(o,s),o[5].random||i.p(o,s)},d(o){r&&r.d(o),o&&v(e),i&&i.d(o),o&&v(n)}}}function Qe(t){let e,n,r,i;return{c(){e=_("input"),m(e,"class","id-input svelte-2v4sah"),m(e,"type","number"),m(e,"placeholder","123"),e.value=n=t[4]||""},m(o,s){y(o,e,s),r||(i=[N(e,"keypress",$e),N(e,"change",t[15])],r=!0)},p(o,s){s&16&&n!==(n=o[4]||"")&&e.value!==n&&(e.value=n)},d(o){o&&v(e),r=!1,B(i)}}}function Ve(t){let e,n,r;return{c(){e=_("button"),e.textContent="Random",m(e,"class","svelte-2v4sah")},m(i,o){y(i,e,o),n||(r=N(e,"click",t[6]),n=!0)},p:C,d(i){i&&v(e),n=!1,r()}}}function Ze(t){let e,n,r,i,o,s,f,c,u,E,b,j,k,p;function S(l,T){if(l[2]==="notloaded")return Xe;if(l[2]==="creating")return He;if(l[2]==="invalidid")return De;if(l[2]==="unavailable")return qe;if(l[2]==="noproject")return Ye;if(l[2]==="projectunavailable")return Ue;if(l[2]==="loading")return Ae;if(l[2]==="ok")return Fe}let x=S(t),g=x&&x(t);function I(l){t[10](l)}function O(l){t[11](l)}function F(l){t[12](l)}function A(l){t[13](l)}function U(l){t[14](l)}let h={serverUrl:W};t[4]!==void 0&&(h.id=t[4]),t[1]!==void 0&&(h.reduxStore=t[1]),t[0]!==void 0&&(h.projectTitle=t[0]),t[2]!==void 0&&(h.projectStatus=t[2]),t[3]!==void 0&&(h.playerMode=t[3]),o=new Oe({props:h}),M.push(()=>D(o,"id",I)),M.push(()=>D(o,"reduxStore",O)),M.push(()=>D(o,"projectTitle",F)),M.push(()=>D(o,"projectStatus",A)),M.push(()=>D(o,"playerMode",U));let d=!(t[2]==="loading"||t[2]==="creating")&&ae(t);return{c(){e=_("main"),n=_("div"),g&&g.c(),r=z(),i=_("div"),Me(o.$$.fragment),b=z(),d&&d.c(),j=z(),k=_("p"),k.textContent="Disclaimer: Scratch Community Edition is not associated or affiliated with the Scratch website or any of the organizations that maintain it.",m(i,"class","player"),m(n,"class","anarchy-player"),m(k,"class","disclaimer svelte-2v4sah"),m(e,"class","svelte-2v4sah")},m(l,T){y(l,e,T),w(e,n),g&&g.m(n,null),w(n,r),w(n,i),me(o,i,null),w(n,b),d&&d.m(n,null),w(e,j),w(e,k),p=!0},p(l,[T]){x===(x=S(l))&&g?g.p(l,T):(g&&g.d(1),g=x&&x(l),g&&(g.c(),g.m(n,r)));const a={};!s&&T&16&&(s=!0,a.id=l[4],q(()=>s=!1)),!f&&T&2&&(f=!0,a.reduxStore=l[1],q(()=>f=!1)),!c&&T&1&&(c=!0,a.projectTitle=l[0],q(()=>c=!1)),!u&&T&4&&(u=!0,a.projectStatus=l[2],q(()=>u=!1)),!E&&T&8&&(E=!0,a.playerMode=l[3],q(()=>E=!1)),o.$set(a),l[2]==="loading"||l[2]==="creating"?d&&(d.d(1),d=null):d?d.p(l,T):(d=ae(l),d.c(),d.m(n,null))},i(l){p||(pe(o.$$.fragment,l),p=!0)},o(l){Re(o.$$.fragment,l),p=!1},d(l){l&&v(e),g&&g.d(),_e(o),d&&d.d()}}}const W="https://5.187.240.11:443",$e=t=>{const e=t.metaKey||t.key.length!==1||/[+e0-9-]/.test(t.key);return e||t.preventDefault(),e};function et(t,e,n){let r,i,o,s,f=0;const c=new URL(location.href).searchParams,u={seeInside:c.has("no-see-inside")||c.has("no-controls"),name:c.has("no-name")||c.has("no-controls"),create:c.has("no-create")||c.has("no-controls"),id:c.has("no-id")||c.has("no-nav"),random:c.has("no-random")||c.has("no-nav")},E='{"targets":[{"isStage":true,"name":"Stage","variables":{},"lists":{},"broadcasts":{},"blocks":{},"comments":{},"currentCostume":0,"costumes":[{"assetId":"14e46ec3e2ba471c2adfe8f119052307","name":"","bitmapResolution":1,"md5ext":"14e46ec3e2ba471c2adfe8f119052307.svg","dataFormat":"svg","rotationCenterX":0,"rotationCenterY":0}],"sounds":[],"volume":100,"layerOrder":0,"tempo":60,"videoTransparency":50,"videoState":"on","textToSpeechLanguage":null},{"isStage":false,"name":"Communicat","variables":{},"lists":{},"broadcasts":{},"blocks":{},"comments":{},"currentCostume":0,"costumes":[{"assetId":"b551df3ba49e6475928309214f51bd94","name":"Communicat-a","bitmapResolution":1,"md5ext":"b551df3ba49e6475928309214f51bd94.svg","dataFormat":"svg","rotationCenterX":48.20865451049096,"rotationCenterY":49.61842375318162},{"assetId":"b62c61a6c0384f71872990115d93eea8","name":"Communicat-b","bitmapResolution":1,"md5ext":"b62c61a6c0384f71872990115d93eea8.svg","dataFormat":"svg","rotationCenterX":46.1326061009419,"rotationCenterY":52.471372930065456},{"assetId":"814a2e4591c4eab9e832b88d16d3988d","name":"Communicat-c","bitmapResolution":1,"md5ext":"814a2e4591c4eab9e832b88d16d3988d.svg","dataFormat":"svg","rotationCenterX":55.23697676581517,"rotationCenterY":29.391930273437737},{"assetId":"78ed5bb0fefd8984546468e1a1ebb1b6","name":"Communicat-d","bitmapResolution":1,"md5ext":"78ed5bb0fefd8984546468e1a1ebb1b6.svg","dataFormat":"svg","rotationCenterX":48.44891835577772,"rotationCenterY":41.586213103483544}],"sounds":[{"assetId":"83c36d806dc92327b9e7049a565c6bff","name":"Meow","dataFormat":"wav","rate":48000,"sampleCount":40682,"md5ext":"83c36d806dc92327b9e7049a565c6bff.wav"}],"volume":100,"layerOrder":1,"visible":true,"x":0,"y":0,"size":100,"direction":90,"stretch":100,"draggable":false,"rotationStyle":"all around"}],"monitors":[],"extensions":[],"meta":{"semver":"3.0.0","vm":"0.2.0","agent":""}}';window.addEventListener("hashchange",b);async function b(){location.hash==="#create"?j():location.hash==="#random"?k():n(4,f=Number(location.hash.substring(1))||0)}b();async function j(){n(2,o="creating");const h=await fetch(`${W}/projects/`,{method:"POST",headers:{"Content-Type":"application/json"},body:E}),d=await h.text();if(!h.ok)throw n(2,o="unavailable"),d;let l=JSON.parse(d);return window.location.hash="#"+l["content-name"],l}async function k(){const h=await fetch(W+"/projects/count");if(!h.ok){n(2,o="unavailable");return}const d=await h.text();if(!Number(d)){n(2,o="unavailable");return}const l=Number(d),T=Math.floor(Math.random()*l)+1;window.location.hash="#"+T}const p=()=>{location.hash="#create"};function S(){r=this.value,n(0,r)}const x=()=>{n(3,s="editor")};function g(h){f=h,n(4,f)}function I(h){i=h,n(1,i)}function O(h){r=h,n(0,r)}function F(h){o=h,n(2,o)}function A(h){s=h,n(3,s)}return[r,i,o,s,f,u,k,p,S,x,g,I,O,F,A,h=>{const d=Number(h.target.value);!d&&d!==0||(window.location.hash="#"+d,n(4,f=d))}]}class tt extends ge{constructor(e){super(),be(this,e,et,Ze,ue,{})}}const le=document.getElementById("app");function nt(t,e={}){le.innerHTML="";let n=new t({target:le,...e});return console.info("mounted",t.name.substring(6,t.name.length-1)+";","options:",e),n}nt(tt);
